:root{
  --bg:#0a1224; --panel:#111a33; --card:#0f1730; --muted:#9bb0d4;
  --brand:#2f7dff; --brand-2:#47b0ff; --ok:#24d57a; --warn:#ffaa3c; --bad:#ff4d6d;
  --level1:#2f7dff; --level2:#00c7d6; --level3:#2be3ff;
  --success:#ffd95e; --wine:#5b1730;
  --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.35);
  --fz:16px;
}

*{box-sizing:border-box} html,body{height:100%}
body{
  margin:0; background:linear-gradient(180deg,#0a1224 0%,#0b1630 100%);
  color:#e9f1ff; font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
  line-height:1.5; font-size:var(--fz);
}

/* Topbar */
.topbar{
  position:sticky; top:0; z-index:40;
  display:flex; align-items:center; gap:12px;
  padding:12px 16px; background:rgba(10,18,36,.7); -webkit-backdrop-filter: blur(8px); backdrop-filter: blur(8px);
  border-bottom:1px solid rgba(255,255,255,.06);
}
.brand{display:flex; align-items:center; gap:10px; text-decoration:none; color:#fff}
.brand-mark{width:28px;height:28px;border-radius:8px}
.brand-name{font-weight:700;letter-spacing:.2px}

/* Buttons */
.btn{border:0; padding:12px 16px; border-radius:12px; cursor:pointer}
.btn.primary{background:linear-gradient(90deg,var(--brand) 0%, var(--brand-2) 100%); color:#fff; box-shadow: var(--shadow)}
.btn.soft{background:#17203b; color:#e9f1ff; border:1px solid rgba(255,255,255,.08)}
.btn.ghost{background:transparent; color:#e9f1ff; border:1px solid rgba(255,255,255,.12)}
.btn.pro{background:linear-gradient(90deg,#ffd95e,#ffbb2e); color:#1a1a1a; font-weight:700}
.btn.big{padding:14px 20px; font-size:18px}
.btn.small{padding:8px 10px; font-size:14px}
.icon-btn{background:transparent;border:0;color:#fff;font-size:18px;cursor:pointer}
.icon-btn.close{font-size:20px}

/* Hero rail */
.hero-rail{display:grid; grid-template-columns: 1.15fr .85fr; gap:0; min-height:62vh}
.hero-media{position:relative; overflow:hidden}
.hero-media img, .hero-media video{width:100%; height:100%; object-fit:cover; display:block}
.hero-vignette{position:absolute; inset:0; background: radial-gradient(45% 60% at 70% 50%, rgba(10,18,36,0) 0%, rgba(10,18,36,.7) 60%, rgba(10,18,36,.95) 100%)}
.hero-content{display:flex; flex-direction:column; justify-content:center; padding:32px}
.lockup{display:flex; flex-direction:column; gap:8px; margin-bottom:16px}
.lockup-mark{width:54px;height:54px;border-radius:14px}
.lockup-title{margin:0; font-size:28px; font-weight:800}
.lockup-kicker{color:#9bb0d4; margin:0}
.cta-row{display:flex; gap:12px; margin:16px 0 8px}

/* Status */
.status-row{margin-top:8px}
.status-pill{display:inline-block; padding:8px 12px; border-radius:999px; background:#162143; color:#cfe1ff; border:1px solid rgba(255,255,255,.06)}

/* Continuous streak bar with redemption pip */
.streak-wrap{margin-top:16px}
.streak-bar-cont{
  position:relative; height:12px; border-radius:999px; background:#1a2547;
  outline:1px solid rgba(255,255,255,.06); overflow:hidden;
}
.streak-fill{
  position:absolute; inset:0; width:0%;
  background:linear-gradient(90deg, var(--level1), var(--level2), var(--level3));
  transition: width .35s ease;
}
.streak-redemption{
  position:absolute; left:42.85%; top:0; bottom:0; width:2px;
  background:linear-gradient(180deg, rgba(255,255,255,.65), rgba(255,255,255,.1));
}
.streak-meta{display:flex; justify-content:space-between; color:#9bb0d4; margin-top:8px}
.level-pill{padding:4px 10px; border-radius:999px; background:#13204a; color:#cfe1ff; border:1px solid rgba(255,255,255,.08)}

/* Panels */
.panel-grid{display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:16px; padding:16px}
.card{
  background:linear-gradient(180deg,#0f1730 0%, #0c142a 100%);
  border:1px solid rgba(255,255,255,.06); border-radius:var(--radius);
  box-shadow: var(--shadow); padding:16px
}
.panel-title{margin:0 0 10px 0}
.avatar-area{display:flex; justify-content:center; align-items:center; padding:8px}
.avatar-area img{width:180px; height:auto}
.chip-row{display:flex; gap:8px; flex-wrap:wrap}
.chip{padding:6px 10px; border-radius:999px; background:#162143; color:#cfe1ff; border:1px solid rgba(255,255,255,.08)}
.flow-list{margin:8px 0 16px 18px}

/* Quiz layer */
.quiz-layer{position:fixed; inset:0; background:rgba(6,10,20,.75); backdrop-filter: blur(8px); display:flex; align-items:center; justify-content:center; z-index:60}
.quiz-card{width:min(900px,92vw); padding:18px}
.top-controls{display:flex; align-items:center; justify-content:space-between; margin-bottom:10px}
.elapsed{color:#9bb0d4}
.progress{color:#9bb0d4}
.qtimer-wrapper{height:6px; border-radius:999px; background:#192246; overflow:hidden; margin:10px 0 14px}
.qtimer-bar{height:100%; width:0%; background:linear-gradient(90deg,var(--level1), var(--level2)); transition:width .2s linear}
.question-box{
  font-size:22px; line-height:1.35; padding:14px; border-radius:14px; background:#0e1833; border:1px solid rgba(255,255,255,.06); min-height:64px
}
.choices{display:grid; gap:10px; margin:14px 0}
.choices button{
  text-align:left; padding:12px; border-radius:12px; border:1px solid rgba(255,255,255,.06);
  background:#121d3a; color:#e9f1ff; cursor:pointer
}
.choices button.correct{background:rgba(36,213,122,.12); border-color:#24d57a}
.choices button.wrong{background:rgba(255,77,109,.12); border-color:#ff4d6d}
.controls{display:flex; gap:10px; margin-top:10px}
.footer{margin-top:12px; text-align:center}

/* Countdown overlay */
.countdown{position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:80}
.countdown.hidden{display:none}
.bubble{
  width:140px; height:140px; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  background: radial-gradient(60% 60% at 50% 40%, rgba(71,176,255,.3), rgba(15,33,74,.8));
  color:#fff; font-size:64px; font-weight:900; box-shadow: 0 10px 28px rgba(0,0,0,.45);
  animation: pop .4s ease
}
@keyframes pop{from{transform:scale(.7);opacity:.0} to{transform:scale(1);opacity:1}}

/* Perfect burst */
#perfectBurst{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:90}
#perfectBurst.active{display:flex}
.burst-core{
  width:220px; height:220px; border-radius:50%;
  background: radial-gradient(55% 55% at 50% 50%, rgba(255,217,94,.9), rgba(255,187,46,.2));
  box-shadow: 0 0 90px rgba(255,217,94,.45);
  animation: throb 1.2s ease-out
}
@keyframes throb{0%{transform:scale(.6);opacity:.2}100%{transform:scale(1);opacity:1}}
.sparkles{position:absolute; width:100%; height:100%; pointer-events:none}
.sparkles i{position:absolute; width:6px; height:6px; background:#fff; border-radius:50%; opacity:.85; animation: sparkle 1.1s ease-out infinite}
.sparkles i:nth-child(odd){animation-delay:.15s}
@keyframes sparkle{0%{transform:translate(0,0) scale(.6)}100%{transform:translate(calc(80px - 160px * var(--r, .5)), calc(80px - 160px * var(--r2,.5))) scale(0)}}
.perfect-text{position:absolute; color:#1a1a1a; font-weight:900; font-size:34px; text-shadow: 0 1px 0 #fff4, 0 6px 30px #0008}

/* Side menu */
.side-menu{position:fixed; inset:0 30% 0 0; background:#0a1224; transform:translateX(-100%); transition:.25s ease; z-index:70; border-right:1px solid rgba(255,255,255,.06)}
.side-menu[aria-hidden="false"]{transform:none}
.side-menu-inner{padding:14px}
.menu-nav{display:flex; flex-direction:column; gap:10px}
.menu-nav a{color:#e9f1ff; text-decoration:none; padding:10px 12px; border-radius:10px; background:#101a35; border:1px solid rgba(255,255,255,.06)}
.scrim{position:fixed; inset:0; background:rgba(0,0,0,.4); z-index:65}

/* Footer */
.footer{padding:24px; text-align:center; color:#9bb0d4}

/* Responsive */
@media (max-width: 980px){
  .hero-rail{grid-template-columns: 1fr}
  .panel-grid{grid-template-columns: 1fr}
}
