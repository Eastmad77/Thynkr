<!DOCTYPE html>
<html lang="en" data-anim="on">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Whylee — Free vs Pro Storyboard (Animated Grid)</title>
  <style>
    :root{
      --bg:#0a0e17;                 /* deep navy/black */
      --panel:#0f1422;
      --card:#0b1020;
      --edge:#101623;
      --steel:#9aa3ad;              /* muted steel gray */
      --text:#dbe2ea;
      --accent:#2f7cff;
      --gold-1:#f5d36b;
      --gold-2:#caa54e;
      --radius:18px;
      --radius-sm:12px;
      --gap:16px;
      --shadow: 0 10px 30px rgba(0,0,0,.45), 0 2px 10px rgba(0,0,0,.35);
      --glow: 0 0 0 1px rgba(245,211,107,.10), 0 10px 30px rgba(245,211,107,.12), 0 0 60px rgba(245,211,107,.10) inset;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 800px at 20% -10%, #0f1a2f 0%, transparent 60%),
        radial-gradient(1200px 800px at 120% 10%, #0b1430 0%, transparent 55%),
        var(--bg);
      color:var(--text);
      line-height:1.45;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Header */
    .top{
      position:sticky; top:0; z-index:10;
      background: linear-gradient(180deg, rgba(10,14,23,.85), rgba(10,14,23,.65), rgba(10,14,23,0));
      backdrop-filter: blur(6px);
      padding: 22px 18px 10px;
      border-bottom: 1px solid #0e1524;
    }
    .title{
      display:flex; align-items:center; gap:12px; flex-wrap:wrap;
      max-width:1200px; margin:0 auto;
    }
    .title h1{
      margin:0; font-size: clamp(20px, 3.2vw, 30px); letter-spacing:.2px; font-weight:700;
      text-shadow: 0 1px 0 #000;
    }
    .legend{
      margin-left:auto; display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    }
    .tag{
      display:inline-flex; align-items:center; gap:8px; padding:6px 10px;
      border:1px solid #16223a; color:#c7d0db; background:#0b1222; border-radius:999px; font-size:13px;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
    }
    .dot{width:10px; height:10px; border-radius:50%;}
    .dot.free{background:#6b9cff;}
    .dot.pro{
      background: linear-gradient(135deg,var(--gold-1),var(--gold-2));
      box-shadow: 0 0 0 1px rgba(202,165,78,.25);
    }

    /* Animations toggle */
    .toggle{
      display:inline-flex; align-items:center; gap:8px; margin-left:8px; padding:6px 10px;
      border:1px solid #16223a; color:#c7d0db; background:#0b1222; border-radius:999px; font-size:13px;
      cursor:pointer; user-select:none;
    }
    .toggle input{appearance:none; width:34px; height:20px; background:#26324a; border-radius:999px; position:relative; outline:none; border:1px solid #1a2740}
    .toggle input::after{
      content:""; position:absolute; top:1px; left:1px; width:16px; height:16px; border-radius:50%;
      background:#cfd8e3; transition: transform .2s ease;
    }
    .toggle input:checked{background:#2d3f62}
    .toggle input:checked::after{ transform: translateX(14px); }

    /* Main grid */
    .wrap{max-width:1200px; margin:20px auto 60px; padding:0 18px;}
    .grid{
      display:grid; gap: var(--gap);
      grid-template-columns: 1fr 1fr;
    }
    @media (max-width: 920px){
      .grid{grid-template-columns: 1fr}
    }

    .col{
      position:relative;
      background: linear-gradient(180deg, rgba(14,20,36,.65), rgba(10,16,30,.55));
      border:1px solid var(--edge);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
      min-width:0;
      overflow:hidden;
    }
    .col h2{
      margin:4px 6px 12px; font-size: clamp(16px, 2.1vw, 18px);
      font-weight:700; color:#cfd7e0; letter-spacing:.3px;
      display:flex; align-items:center; gap:8px;
    }
    .col h2 .flag{
      font-size:11px; letter-spacing:.6px; text-transform:uppercase;
      padding:4px 8px; border-radius:999px; border:1px solid #17233b; color:#97a4b3; background:#0b1222;
    }
    .stack{
      display:grid; gap: var(--gap);
    }

    /* Scene card */
    .card{
      position:relative;
      background: linear-gradient(180deg, #0b1020, #0a0f1d);
      border:1px solid #101829;
      border-radius: var(--radius-sm);
      overflow:hidden;
      box-shadow: var(--shadow);
      transform: translateZ(0);
      transition: border-color .2s ease, box-shadow .2s ease;
    }
    .card:hover{
      box-shadow: 0 14px 36px rgba(0,0,0,.55);
      border-color:#15233d;
    }
    .frame{
      position:relative; aspect-ratio: 16/9;
      background:#070a12;
      contain: content;                 /* performance containment */
      overflow:hidden;
    }
    .frame img{
      position:absolute; inset:0; width:100%; height:100%; object-fit:cover;
      filter: contrast(1.02) saturate(1.02) brightness(.98);
      transform: translateZ(0);
    }
    .meta{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding: 10px 12px;
      border-top:1px solid #0f1a2f;
      background: linear-gradient(180deg, rgba(10,16,30,.55), rgba(9,14,25,.65));
    }
    .label{ display:flex; align-items:baseline; gap:8px; color:#c9d2dc; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .scene-num{ font-weight:800; font-size:12px; letter-spacing:1.4px; color:#7d8aa1; text-transform:uppercase; }
    .scene-name{ font-weight:700; font-size:14px; color:#dfe6ee; letter-spacing:.2px; }
    .hint{ font-size:12px; color:#8e99a6; }

    /* Pro ribbon & glow on cards */
    .pro .frame::after{
      content:"PRO";
      position:absolute; top:12px; right:-38px; z-index:2;
      transform: rotate(45deg);
      padding: 8px 54px;
      font-weight:800; font-size:12px; letter-spacing:2px; color:#1a1305;
      background: linear-gradient(135deg, var(--gold-1), var(--gold-2));
      box-shadow: 0 6px 20px rgba(202,165,78,.35);
      border:1px solid rgba(40,28,6,.35);
      text-shadow: 0 1px 0 rgba(255,255,255,.35);
      pointer-events:none;
    }
    .pro .frame::before{
      content:""; position:absolute; inset:-10%;
      background:
        radial-gradient(60% 70% at 65% 20%, rgba(245,211,107,.20), transparent 55%),
        radial-gradient(45% 60% at 30% 80%, rgba(202,165,78,.14), transparent 60%);
      mix-blend-mode: screen;
      pointer-events:none;
      z-index:1;
    }
    .pro{
      box-shadow: var(--shadow), 0 0 0 1px rgba(202,165,78,.08) inset, var(--glow);
      border-color:#1b2337;
    }

    /* Column-level subtle shimmer pulse (very light) */
    .col.pro-col::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        linear-gradient(110deg, transparent 40%, rgba(245,211,107,.06) 50%, transparent 60%),
        radial-gradient(60% 100% at 120% -20%, rgba(245,211,107,.04), transparent);
      pointer-events:none;
      animation: shimmer 6s linear infinite;
      opacity:.7;
    }
    @keyframes shimmer{
      0%   { background-position: -200% 0, 0 0; }
      100% { background-position: 200% 0, 0 0; }
    }

    /* Fade-in on reveal */
    .reveal{
      opacity:0; transform: translateY(12px);
    }
    html[data-anim="on"] .reveal.is-visible{
      animation: fadeUp .6s cubic-bezier(.2,.7,.2,1) var(--stagger,0ms) forwards;
      will-change: opacity, transform;
    }
    @keyframes fadeUp{
      to{ opacity:1; transform: translateY(0) }
    }

    /* Parallax (applied inline via transform) */
    html[data-anim="on"] .frame img.parallax{
      will-change: transform;
    }

    /* Footer */
    footer{
      max-width:1200px; margin:28px auto 70px; padding:0 18px; color:var(--steel);
      font-size:13px; text-align:center;
    }
    footer .note{
      display:inline-block; padding:10px 12px; border:1px dashed #213052; border-radius:12px;
      background: #0a1120;
    }

    /* Accessibility: reduce motion */
    @media (prefers-reduced-motion: reduce){
      html{ scroll-behavior: auto; }
      .reveal{ opacity:1; transform:none; animation:none !important }
      .frame img.parallax{ transform:none !important; will-change:auto !important; }
      .col.pro-col::before{ animation:none; opacity:.25; } /* static faint glow */
    }

    /* Live toggle OFF (also acts like reduce) */
    html[data-anim="off"] .reveal{ opacity:1; transform:none; animation:none !important }
    html[data-anim="off"] .frame img.parallax{ transform:none !important; will-change:auto !important }
    html[data-anim="off"] .col.pro-col::before{ animation:none; opacity:.25; }
    html[data-anim="off"] .card{ transition: border-color .2s ease, box-shadow .2s ease; }

    /* Keyboard focus */
    .card:focus-within, .card:focus { outline:2px solid var(--accent); outline-offset:2px; }

    /* Tiny utility */
    .sr{position:absolute!important; width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body>
  <header class="top">
    <div class="title">
      <h1>Whylee — Free vs Pro Storyboard (Animated)</h1>

      <span class="tag"><span class="dot free"></span> Free</span>
      <span class="tag"><span class="dot pro"></span> Pro</span>

      <label class="toggle" title="Toggle animations">
        <span>Animations</span>
        <input id="animSwitch" type="checkbox" aria-label="Animations On/Off">
      </label>
    </div>
  </header>

  <main class="wrap">
    <section class="grid" id="grid">
      <!-- Left: Free -->
      <div class="col" id="free-col">
        <h2>Free <span class="flag">Cinematic flow</span></h2>
        <div class="stack" id="free-stack" aria-label="Free storyboard"></div>
      </div>

      <!-- Right: Pro -->
      <div class="col pro-col" id="pro-col">
        <h2>Pro <span class="flag">Cinematic flow</span></h2>
        <div class="stack" id="pro-stack" aria-label="Pro storyboard"></div>
      </div>
    </section>
  </main>

  <footer>
    <p class="note">Tip: Press Ctrl/Cmd + / − to zoom. Adjust paths in the arrays if posters are moved.</p>
  </footer>

  <script>
    // ------- Data (asset set provided) -------
    const posterBase = '/media/posters';
    const postersFree = [
      `${posterBase}/poster-01-start.jpg`,
      `${posterBase}/poster-02-mode.jpg`,
      `${posterBase}/poster-03-reward.jpg`,
      `${posterBase}/poster-04-reflection.jpg`,
      `${posterBase}/poster-05-upgrade.jpg`,
      `${posterBase}/poster-06-challenge.jpg`,
      `${posterBase}/poster-07-pro.jpg`,
      `${posterBase}/poster-08-levelup.jpg`,
      `${posterBase}/poster-09-community.jpg`,
      `${posterBase}/poster-10-brand.jpg`
    ];

    const namesFree = [
      'Start',
      'Mode Select',
      'Reward',
      'Reflection',
      'Upgrade',
      'Challenge',
      'Pro (Teaser)',
      'Level Up',
      'Community',
      'Brand'
    ];

    // Pro sequence difference: swap Scene 05 to Rewards (poster-07-pro.jpg) instead of Upgrade.
    const postersPro = postersFree.slice();
    postersPro[4] = `${posterBase}/poster-07-pro.jpg`; // Scene 05 becomes Rewards (Pro)
    const namesPro = namesFree.slice();
    namesPro[4] = 'Rewards';

    // ------- Build helpers -------
    const freeStack = document.getElementById('free-stack');
    const proStack  = document.getElementById('pro-stack');

    function pad2(n){ return String(n).padStart(2,'0'); }

    function makeCard({src, index, name, isPro=false}){
      const card = document.createElement('article');
      card.className = 'card reveal' + (isPro ? ' pro' : '');
      card.tabIndex = 0;
      card.style.setProperty('--stagger', `${Math.min(50 + index*70, 120)}ms`);

      const frame = document.createElement('div');
      frame.className = 'frame';

      const img = document.createElement('img');
      img.loading = 'lazy';
      img.decoding = 'async';
      img.src = src;
      img.alt = (isPro ? 'Pro' : 'Free') + ` storyboard scene ${pad2(index+1)} – ${name}`;
      img.className = 'parallax';
      img.setAttribute('data-depth', isPro ? '1.0' : '0.9'); // subtle difference

      frame.appendChild(img);

      const meta = document.createElement('div');
      meta.className = 'meta';

      const label = document.createElement('div');
      label.className = 'label';
      const num = document.createElement('span');
      num.className = 'scene-num';
      num.textContent = pad2(index+1);
      const nm = document.createElement('span');
      nm.className = 'scene-name';
      nm.textContent = name;
      label.appendChild(num); label.appendChild(nm);

      const hint = document.createElement('span');
      hint.className = 'hint';
      hint.textContent = isPro ? 'Pro cinematic' : 'Free cinematic';

      meta.appendChild(label); meta.appendChild(hint);

      card.appendChild(frame);
      card.appendChild(meta);
      return card;
    }

    postersFree.forEach((src, i) => {
      freeStack.appendChild(makeCard({src, index:i, name:namesFree[i], isPro:false}));
    });
    postersPro.forEach((src, i) => {
      proStack.appendChild(makeCard({src, index:i, name:namesPro[i] || namesFree[i], isPro:true}));
    });

    // ------- Animations: controls & accessibility -------
    const animSwitch = document.getElementById('animSwitch');
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    // Default toggle state: Off if user prefers reduced motion.
    if(prefersReduced){
      document.documentElement.setAttribute('data-anim','off');
      animSwitch.checked = false;
    } else {
      document.documentElement.setAttribute('data-anim','on');
      animSwitch.checked = true;
    }

    animSwitch.addEventListener('change', ()=>{
      document.documentElement.setAttribute('data-anim', animSwitch.checked ? 'on' : 'off');
    });

    // ------- IntersectionObserver: fade-in on reveal -------
    const revealEls = Array.from(document.querySelectorAll('.reveal'));
    if('IntersectionObserver' in window){
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(entry=>{
          if(entry.isIntersecting){
            entry.target.classList.add('is-visible');
            // Remove will-change after animation completes to avoid thrash
            const clean = ()=> entry.target.style.willChange = 'auto';
            entry.target.addEventListener('animationend', clean, {once:true});
            io.unobserve(entry.target);
          }
        });
      }, { root: null, rootMargin: '0px 0px -5% 0px', threshold: 0.15 });
      revealEls.forEach(el=>{
        el.style.willChange = 'opacity, transform';
        io.observe(el);
      });
    } else {
      // Fallback: show all
      revealEls.forEach(el=> el.classList.add('is-visible'));
    }

    // ------- Scroll-based parallax (requestAnimationFrame + guard) -------
    const parallaxImgs = Array.from(document.querySelectorAll('.frame img.parallax'));
    let ticking = false;

    function applyParallax(){
      ticking = false;
      if(document.documentElement.getAttribute('data-anim') === 'off') {
        parallaxImgs.forEach(img=>{ img.style.transform = 'translate3d(0,0,0)'; img.style.willChange='auto'; });
        return;
      }
      const viewH = window.innerHeight;
      const maxRange = window.innerWidth < 600 ? 6 : 10; // -10..+10px desktop, capped on mobile
      parallaxImgs.forEach(img=>{
        const rect = img.getBoundingClientRect();
        const center = rect.top + rect.height/2;
        const norm = Math.max(-1, Math.min(1, (center - viewH/2) / (viewH/2))); // -1..1
        const depth = parseFloat(img.getAttribute('data-depth') || '1');
        const offset = -norm * maxRange * depth; // px
        img.style.transform = `translate3d(0, ${offset.toFixed(2)}px, 0)`;
        img.style.willChange = 'transform';
      });
    }

    function onScroll(){
      if(!ticking){
        ticking = true;
        requestAnimationFrame(applyParallax);
      }
    }

    // Only attach parallax when animations are ON
    const attachParallax = ()=>{
      window.addEventListener('scroll', onScroll, {passive:true});
      window.addEventListener('resize', onScroll, {passive:true});
      applyParallax();
    };
    const detachParallax = ()=>{
      window.removeEventListener('scroll', onScroll);
      window.removeEventListener('resize', onScroll);
      parallaxImgs.forEach(img=>{ img.style.transform = 'translate3d(0,0,0)'; img.style.willChange='auto'; });
    };

    // React to live toggle changes
    const animObserver = new MutationObserver(()=>{
      if(document.documentElement.getAttribute('data-anim') === 'on'){
        attachParallax();
      } else {
        detachParallax();
      }
    });
    animObserver.observe(document.documentElement, { attributes:true, attributeFilter:['data-anim'] });

    // Init parallax if allowed
    if(!prefersReduced) attachParallax();

    // Improve first paint feel
    window.addEventListener('load', ()=> {
      requestAnimationFrame(applyParallax);
    });
  </script>
</body>
</html>
